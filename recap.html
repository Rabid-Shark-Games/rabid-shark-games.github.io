<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Recap</title>

	<link rel="stylesheet" type="text/css" href="reveal/reset.css">
	<link rel="stylesheet" type="text/css" href="reveal/reveal.css">
	<link rel="stylesheet" type="text/css" href="reveal/simple.css">

	<style>

#sndplay {
	position: absolute;
	left: 5px;
	top: 5px;
	z-index: 100;
}

	</style>
</head>
<body>

<audio loop id="sound">
	<source src="cadenrecap.ogg" type="audio/ogg">
</audio>

<button id="sndplay">üéµ</button>

<div class="reveal" id="reveal" style="display: none">
	<div class="slides">
		<section>Hello, <span id="name"></span><br/>(Press the üéµ button to listen to the soundtrack!)</section>
		<section>You had quite the year, didn't you?</section>
		<section><span id="threat"></span></section>
		<section>Remember listening to music?</section>
		<section>In total, you listened to <span id="music"></span> minutes!</section>
		<section>That's <span id="bananas"></span></section>
		<section>Your favorite genre?</section>
		<section><span id="genre"></span></section>
		<section>But you know what you did more?</section>
		<section>That's right!<br/>Scrolling short-form video content!</section>
		<section>In total, you scrolled for <span id="reels"></span> minutes!</section>
		<section>(That's enough to fill three olympic-sized swimming pools!)</section>
		<section>But you know what's crazier than that?</section>
		<section>In total, you remember 0 of those videos!</section>
		<section>...</section>
		<section><span id="apology"></span></section>
		<section>Remember games?</section>
		<section>I forgot what I was going to say here</section>
		<section>You spent...<br/><span id="time1"></span><br/><span id="time2"></span><br/><span id="time3"></span></section>
		<section>Your favorite TV show was <span id="tv"></span></section>
		<section>And finally...</section>
		<section><span id="finally"></span>
	</div>
</div>


<script src="reveal/reveal.js"></script>
<script>

const hashCode = s => s.split('').reduce((a,b) => (((a << 5) - a) + b.charCodeAt(0))|0, 0);
window.$ = (x) => document.getElementById(x);
window.T = (x, t) => $(x).innerText = t;
window.C = (c) => c[Math.floor(window.rng() * c.length)];
window.CMA = (n) => Math.floor(n).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
window.CMAD = (n) => (Math.floor(n * 100) / 100).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
window.S = (a) => a.toSorted(() => 0.5 - window.rng());

function mulberry32(a) {
  return function() {
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ t >>> 15, t | 1);
    t ^= t + Math.imul(t ^ t >>> 7, t | 61);
    return ((t ^ t >>> 14) >>> 0) / 4294967296;
  }
}

(()=>{
	const pname = localStorage.getItem('recapName');
	if (pname == undefined || !pname || pname == 'null') {
		localStorage.setItem('recapName', (prompt("Please enter your name") ?? "").trim().toLowerCase());
		location.reload();
		return;
	}
	alert("You are logged in as " + pname);
	$("sndplay").onclick = () => $("sound").play();
	$("sound").volume = 0.2;
	$("sound").addEventListener('timeupdate', function(){
	    var buffer = .44;
	    if(this.currentTime > this.duration - buffer){
	        this.currentTime = 0;
	        this.play();
	    }
	});

	const namehash = hashCode(pname);
	window.rng = mulberry32((namehash + 67 + 0xABDA878) & (2**32 - 1));
	// window.rng = () => Math.random();

	T("name", pname.replaceAll(/(^|\s)+./g, l=>l.toUpperCase()));
	T("threat", C(["You know why I said that",
	              "...",
	              "Quite the GOOD year that is!",
	              "But what doesn't kill you makes you stronger!",
	              "Not like that matters",
	              "Especially on " + C(["June", "July", "August", "October", "November", "February", "March"])
	                               + C(["11th", "14th", "2nd", "5th", "19th", "23rd", "12th", "9th", "6th", "16th"]),
	              "But now it's over.",
	              "Didn't you.",
	              "Full of fun and glee!",
	              "Remember when you came out?",
	              "I remember it all"]));
	T("music", CMA(rng() * 80000));
	T("bananas", C(["still not enough",
		            CMA(rng() * 1000) + "bananas!",
		            CMA(rng() * 500) + "yards!",
		            CMAD(rng() * 300) + "years!",
		            "$" + CMAD(rng() * 150) + " worth of Spotify Premium!",
		            "time you'll never get back",
		            "ok though. I forgive you",
	                "soooo much!"]));
	T("genre", C(["Bad.",
	              "Jazz fusion from 2014",
	              "Microtonal nonsense",
	              "Pop",
	              "R&B",
	              "D&B",
	              "Video game soundtracks from your childhood",
	              "Listening to the same song twenty thousand times",
	              "Spotify DJ",
	              "None of them! You didn't enjoy a single song",
	              "Carti B",
	              "Human noises",
	              "The Blue Man Group",
	              "Mongolian throat singing",
	              "slurping"]));
	T("reels", CMA(rng() * 3000000));
	T("apology", C(["Well, at least you're not alone in that",
	                "Can't do anything about that anymore!",
	                "Sorry."]))
	const times = S([CMA(rng() * 10000) + " minutes on a Discord call",
	                 "Most of your time thinking about how you were spending your time",
	                 "$" + CMAD(rng() * 20000) + " on a cool trinket",
	                 "Your time wisely",
	                 "Too much overall",
	                 CMA(rng() * 5000) + " minutes on Reddit",
	                 CMA(rng() * 5000) + " minutes watching livestreams on Kick",
	                 CMA(rng() * 100) + " minutes rewatching Danny Phantom",
	                 CMA(rng() * 300) + " minutes watching people on the street",
	                 CMA(rng() * 2000) + " minutes in Incognito",
	                 CMA(rng() * 90) + " hours in a monastery",
	                 CMA(rng() * 50) + " hours watching video essays about other video essays",
	                 CMA(rng() * 9000) + " minutes doing homework",
	                 CMA(rng() * 50) + " hours arguing online",
	                 CMA(rng() * 500) + " seconds on this website",
	                 CMA(rng() * 100000) + " minutes pretending to be another sexuality",
	                 "A couple dollars here and there"]);
	T("time1", times[0]);
	T("time2", times[1]);
	T("time3", times[2]);
	T("tv", C(["Danny Phantom",
		       "Community",
		       "The YouTube app",
		       "South Park",
		       "Late Night with Stephen Colbert",
		       "The Sean Hannity Show",
		       "Conan",
		       "PLUR1BUS",
		       "Breaking Bad",
		       "Severance",
		       "The Chair Company",
		       "Taskmaster",
		       "clips of Pixels (2015)",
		       "Nathan for You",
		       "How To with John Wilson",
		       "Am I Racist (2024), which isn't a TV show, but you think it deserves one",
		       "the second season of The Rehersal",
		       "Dexter",
		       "Spy x Family",
		       "Panty & Stocking",
		       "It's Always Sunny in Philadelphia",
		       "The Sex Lives of College Girls",
		       "Smiling Friends",
	           "Rick and Morty"]))
	T("finally", C(["Your favorite Discord server was this one",
	                "Just kidding! There's still time left in the year!",
	                "Finally... Finally...",
	                "‚ù§Ô∏è",
	                "You ended here!",
	                "You did a lot of cool stuff"]))

	$("reveal").style.display = null;
	Reveal.initialize({
		mouseWheel: true,
		progress: false
	});
})();

</script>

</body>
</html>